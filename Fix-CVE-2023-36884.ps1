<# 
    .NOTES
    ========================================================================
         
         NAME: Fix-CVE-2023-36884
         DESCRIÇÃO: Solução temporária para mitigar a vulnerabilidade CVE-2023-36884. 
                    Esta vulnerabilidade afeta o sistema operacional Windows e pode permitir 
                    a execução remota de código malicioso.
         AUTHOR: DicasQueFunfa
         DATE  : 28/07/2023
         
    ==========================================================================
#>
# Define o caminho da chave do registro
$regPath = "HKLM:\SOFTWARE\Policies\Microsoft\Internet Explorer\Main\FeatureControl\FEATURE_BLOCK_CROSS_PROTOCOL_FILE_NAVIGATION"

# Define a lista de aplicações
$apps = @("Excel.exe", "Graph.exe", "MSAccess.exe", "MSPub.exe", "Powerpnt.exe", "Visio.exe", "WinProj.exe", "WinWord.exe", "Wordpad.exe")

# Verifica se a chave do registro existe e a cria se não existir
if (!(Test-Path $regPath)) {
    New-Item -Path $regPath -Force | Out-Null
}

# Adiciona cada aplicação à chave do registro com um valor de 1
foreach ($app in $apps) {
    Set-ItemProperty -Path $regPath -Name $app -Value 1 -Type DWord -Force
}

Write-Host "Configuração do registro concluída."
